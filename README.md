# Инфраструктура

##### При запуске, сервер управляет зарегестрированными агентами, передавая им задачи по сборке. При нехватке свободных агентов организуется очередь задач.
##### В файле config.js прописан массив портов агентов, которые при запуске сервера агентов ожидают получения тасков.

##### Сервер генерирует уникальные номера сборок. Передает свободному агенту задачу на сборку с коммандой и хэшом коммита. Агент клонирует репозиторий, ссылка которого прописана в файле конфигурации, переключается на переданную ветку и выполняет команду сборки. При отсутствии свободных агентов, происходит ожидание первого освободивщегося агента. При успешной передаче результата сборки серверу, данные сохраняются в файл, имя которого прописан в файле конфигурации в поле "dataFile" в папку server.

##### Сервер отслеживает ошибки на любом этапе сборки.
##### Агент закрывается и прекращает прослушивать сервер при невозможности зарегестрироваться с сервером.
##### При невозможности соединения с сервером после сборки, агент самостоятельно сохраняет результаты а файл в папку agent.